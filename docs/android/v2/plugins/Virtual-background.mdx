---
title: Virtual Background
nav: 15
---

## Introduction

Virtual Background plugin helps in customising oneâ€™s background i.e. replacing the background with a static image.
This guide provides an overview of usage of the Virtual Background plugin of 100ms.

<div style={{textAlign: 'center'}}>

![VirtualBackground](/docs/v2/android-vb.gif)

</div>


## Supported Devices/Versions/Resolutions

-   Minimum Android api level required to support Virtual Background plugin is 21, same as that required for 100ms SDK
-   Minimum 100ms SDK version it can work with is `2.2.2`
-   Virtual background plugin is built for armeabi-v7a, arm64-v8a, x86 and x86_64 architectures
-   We have not extended support for 720p and 1080p resolution for this feature
-   We recommend that you use this feature on a high performance device for smooth experience

## Size Increase Per Architecture

- `x86_64` - 15 MB
-  `x86`   - 14 MB
-  `arm64-v8a` - 14.5 MB
-  `armeabi-v7a` - 11 MB

## Prerequisites

Familiarity with Android Studio and the [fundamentals](https://developer.android.com/training/basics/firstapp) of android apps.

## Common Terms

-   `image background` - The image which the plugin should replace the background with in the user's video.
-   `plugin load time` - The time taken by the plugin to load the  machine learning model for the first time. The machine learning model is what will identify what part of the image the background is and is essential to virtual background working.

## Add dependency

-   Adding the Virtual Background plugin and sdk dependency to your app-level `build.gradle` [![](https://jitpack.io/v/100mslive/android-sdk.svg)](https://jitpack.io/#100mslive/android-sdk).

```json{3,4}:build.gradle
dependencies {
 // See the version in the jitpack badge above.
 implementation 'com.github.100mslive:android-sdk-virtual-background:x.x.x'
 implementation 'com.github.100mslive:android-sdk:x.x.x'
    }
```
## Interfaces

### Instantiate VirtualBackground

Instantiate the 100ms Virtual Background plugin like this:

<Tabs id="instanstiate-VirtualBackground" items={['Kotlin', 'Java']} />

<Tab id='instanstiate-VirtualBackground-0'>

```kotlin
val hmsSdk = HMSSDK
      .Builder(application)
      .build()
val virtualBackground = HMSVirtualBackground(hmsSdk, imageBitmap)
```

</Tab>

<Tab id='instanstiate-VirtualBackground-1'>

```java
HMSSDK hmsSdk = new HMSSDK
                       .Builder(application)
                       .build();
HMSVirtualBackground virtualBackground = new HMSVirtualBackground(hmsSdk, imageBitmap)
```
</Tab>

That's it. You have instantiated Virtual Background plugin successfully. ðŸ¥³

Now let's take a look at the method signature of HMSVirtualBackground.

`HMSVirtualBackground` accepts 2 arguments -
-   `hmsSdk`: an object of type `HMSSDK` class
-   `imageBitmap`: A background image bitmap you want to replace your background to.

### Check if plugin is supported

`HMSVirtualBackground.isSupported` can be used to check if the API level/Resolution of device is supported or not.
It will return True/False based on these parameters.

<Tabs id="Check-plugin-support" items={['Kotlin', 'Java']} />

<Tab id='Check-plugin-support-0'>

```kotlin
if(virtualBackground.isSupported()){
    console.log("Device/Resolution is supported");
}else{
    console.log("Device/Resolution is not supported, check Supported Devices/Versions/Resolutions section");
}
```
</Tab>

<Tab id='Check-plugin-support-1'>

```java
if(virtualBackground.isSupported()){
    console.log("Device/Resolution is supported");
}else{
    console.log("Device/Resolution is not supported, check Supported Devices/Versions/Resolutions sections");
}
```
</Tab>


### Init(Optional)

Init is used to load the machine learning model of Virtual Background for the first time.
It takes on an average 50-200 ms.<br/>
Calling init is handled internally by SDK if not done by user, in this case addPlugin call will
take 50-200 ms for the first time and then less than 10ms in the subsequent calls.
Check [this section](#add-plugin) for addPlugin API usage

<Tabs id="Init" items={['Kotlin', 'Java']} />

<Tab id='Init-0'>

```kotlin
try{
   virtualBackground.init();
}catch(err){
   console.log("failed to init Plugin", err);
}
```
</Tab>

<Tab id='Init-1'>

```java
try{
   virtualBackground.init();
}catch(err){
   console.log("failed to init Plugin", err);
}
```
</Tab>


### Change Background

Call `setBackground` on the `HMSVirtualBackground` instance to update the background again later if required.
It accepts imageBitmap or String as a parameter

-  `imageBitmap`- Bitmap - A background image bitmap you want to replace your background to.
-  `None` - String - This will remove the background effect from the video

Image will get fit to the video by maintaining the aspect ratio.
If the aspect ratio of the background image is not the same as the video, the image will be cropped to fit in the background.

It will return `true` if background is set properly otherwise returns `false`. In case of `false` value `virtualBackground` plugin sets
background to `None` itself.

<Tabs id="Change-Background" items={['Kotlin', 'Java']} />

<Tab id='Change-Background-0'>

```kotlin
// imageBitmap parameter is explained in Instantiate Virtual Background section

var isSet = virtualBackground.setBackground(imageBitmap | "None");
if(isSet)
   console.log("Background is applied successfully")
}else{
    console.log("Failed to update background, try sending a valid bitmap");
}
```
</Tab>

<Tab id='Change-Background-1'>

```java
// imageBitmap parameter is explained in Instantiate Virtual Background section
var isSet = virtualBackground.setBackground(imageBitmap | "None");
if(isSet)
   console.log("Background is applied successfully")
}else{
    console.log("Failed to update background, try sending a valid bitmap");
}
```
</Tab>

### Tuning pluginFrameRate(Optional)

`pluginFrameRate` - pluginFrameRate helps in controlling the performance and experience of Virtual Background plugin.
pluginFrameRate translates to the number of frames for which background is detected. Higher value will use more resources
(cpu/memory/battery), while making the Virtual Background experience smooth. Lower value will be generous on resources,
 while lowering the Virtual Background smoothness. Recommended value is 15. Values higher than this will not significantly
 improve Virtual Background smoothness but will be heavy on resources. For lower end devices value can be in the range of 7-10.

## Add Plugin

To add Virtual background plugin app needs to call `addPlugin` method of `HMSSDK` which takes in 3 parameters - The first
one is `virtualBackground` instance of the plugin, The second one is `HMSActionResultListener` which is a callback object
needed to inform about success or failure of the action and the third one is `pluginFrameRate` an optional parameter
Check [this section](#tuning-plugin-frame-rate-optional) for its usage

<Tabs id="plugin-code" items={['Kotlin', 'Java']} />

<Tab id='plugin-code-0'>

```kotlin
// This will apply the Virtual Background effect to the local video
hmsSdk.addPlugin(virtualBackground, object : HMSActionResultListener {
       override fun onError(error: HMSException) {
         // an error occurred
       }

       override fun onSuccess() {
         // added successfully
       }
      },
      pluginFrameRate)
```
</Tab>

<Tab id='plugin-code-1'>

```Java
// This will apply the Virtual Background effect to the local video
hmsSdk.addPlugin(virtualBackground, object : HMSActionResultListener {
       override fun onError(error: HMSException) {
         // an error occurred
       }

       override fun onSuccess() {
         // added successfully
       }
     },
     pluginFrameRate)
```
</Tab>

## Remove Plugin

To remove Virtual background plugin app needs to call `removePlugin` method of `HMSSDK` which takes in 2 parameters - The first
one is `virtualBackground` instance of the plugin and the second one is `HMSActionResultListener` which is a callback object
needed to inform about success or failure of the action

<Tabs id="plugin-code" items={['Kotlin', 'Java']} />

<Tab id='plugin-code-0'>

```kotlin
// This will remove the Virtual Background effect from the local video
hmsSdk.removePlugin(virtualBackground, object : HMSActionResultListener {
       override fun onError(error: HMSException) {
         // an error occurred
       }

       override fun onSuccess() {
         // removed successfully
       }
     }
    )
```
</Tab>

<Tab id='plugin-code-1'>

```Java
hmsSdk.removePlugin(virtualBackground, object : HMSActionResultListener {
       override fun onError(error: HMSException) {
         // an error occurred
       }

       override fun onSuccess() {
         // removed successfully
       }
     }
    )
```
</Tab>
