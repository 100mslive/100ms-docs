---
title: PiP Mode (Beta)
nav: 14
---

iOS SDK provides support for creating Picture in Picture mode experience for video calls.

Please note that your app need to have com.apple.developer.avfoundation.multitasking-camera-access entitlement for your app to be able to use PiP mode during video calls.

![com.apple.developer.avfoundation.multitasking-camera-access]([/docs/v2/screenshare-dashboard.png](https://developer.apple.com/documentation/bundleresources/entitlements/com_apple_developer_avfoundation_multitasking-camera-access))

## How Picture in Picture works during video call

When your app goes into the background, your app can no longer access camera and publish it to other peers. Also, you can't see video of any other particiapants in the call if your app is in the background. Both of these issues are resolved if you implements PiP mode for video calling in your app.

### How to add PiP support in your app

1. You create an instance of AVPictureInPictureVideoCallViewController. And add the view that you want to show in PiP window as subview like below:

```swift
    let pipVideoCallViewController = AVPictureInPictureVideoCallViewController()
    pipVideoCallViewController.view.add(subview: ...)
  ```

2. Next, you create a content source from pipVideoCallViewController, also passing a UIView that PiP window will use as source view to animate from. Then you create AVPictureInPictureController with the content source:

```swift
    let pipContentSource = AVPictureInPictureController.ContentSource(
            activeVideoCallSourceView: targetView,
            contentViewController: pipVideoCallViewController)
            
    // Optionally set the target frame as preferred content size for PiP window
    pipVideoCallViewController.preferredContentSize = targetView.frame.size
            
    let pipController = AVPictureInPictureController(contentSource: pipContentSource)
  ```
  
3. To start the PiP mode, you can either call startPictureInPicture on pipController or set it to automatically start when the app goes to background like below:

```swift
    pipController.canStartPictureInPictureAutomaticallyFromInline = true
            
    // Or you can start PiP manually
    pipController.startPictureInPicture()
  ```
  
### How to display participant's video in PiP

AVPictureInPictureController requires source content to use AVSampleBufferDisplayLayer on it's subviews. HMSVideoView uses metal for render video of peers on the call. And metal is currently unsupported by AVPictureInPictureController. That's why you can'y directly use HMSVideoView to draw video views in PiP window. You need to create HMSSampleBufferDisplayView instead.

```swift
    let trackVideoView = HMSSampleBufferDisplayView(frame: .zero, preferredSize: CGSize(width: 640.0, height: 480.0))
  ```

ðŸ‘€ To see an Example iOS broadcast upload extension implementation for screen sharing using 100ms Broadcast extension SDK, checkout [our Example project](https://github.com/100mslive/100ms-ios-sdk/tree/main/Example).

ðŸ“² Download the 100ms fully-featured Sample iOS app here: https://testflight.apple.com/join/dhUSE7N8
